{"version":3,"names":["ChessboardContextProviderComponent","React","forwardRef","ref","children","fen","chess","useConst","Chess","chessboardRef","useRef","boardOperationsRef","board","setBoard","useState","chessboardController","useMemo","move","params","current","highlight","resetAllHighlightedSquares","getState","resetBoard","reset","useImperativeHandle","ChessboardContextProvider","memo"],"sources":["board-context-provider.tsx"],"sourcesContent":["import { Chess } from 'chess.js';\nimport React, { useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport type { ChessboardState } from '../helpers/get-chessboard-state';\nimport { useConst } from '../hooks/use-const';\n\nimport { BoardContext, BoardSetterContext } from './board-context';\nimport {\n  BoardOperationsContextProvider,\n  BoardOperationsRef,\n} from './board-operations-context';\nimport { BoardPromotionContextProvider } from './board-promotion-context';\nimport { BoardRefsContextProvider, ChessboardRef } from './board-refs-context';\nimport { ChessEngineContext } from './chess-engine-context';\n\ntype BoardContextProviderProps = {\n  fen?: string;\n  children?: React.ReactNode;\n};\n\nconst ChessboardContextProviderComponent = React.forwardRef<\n  ChessboardRef,\n  BoardContextProviderProps\n>(({ children, fen }, ref) => {\n  const chess = useConst(() => new Chess(fen));\n  const chessboardRef = useRef<ChessboardRef>(null);\n  const boardOperationsRef = useRef<BoardOperationsRef>(null);\n\n  const [board, setBoard] = useState(chess.board());\n\n  const chessboardController: ChessboardRef = useMemo(() => {\n    return {\n      move: (params) => chessboardRef.current?.move?.(params),\n      highlight: (params) => chessboardRef.current?.highlight(params),\n      resetAllHighlightedSquares: () =>\n        chessboardRef.current?.resetAllHighlightedSquares(),\n      getState: () => chessboardRef?.current?.getState() as ChessboardState,\n      resetBoard: (params) => {\n        chessboardRef.current?.resetBoard(params);\n        boardOperationsRef.current?.reset();\n      },\n    };\n  }, []);\n\n  useImperativeHandle(ref, () => chessboardController, [chessboardController]);\n\n  return (\n    <BoardContext.Provider value={board}>\n      <BoardPromotionContextProvider>\n        <ChessEngineContext.Provider value={chess}>\n          <BoardSetterContext.Provider value={setBoard}>\n            <BoardRefsContextProvider ref={chessboardRef}>\n              <BoardOperationsContextProvider\n                ref={boardOperationsRef}\n                controller={chessboardController}\n              >\n                {children}\n              </BoardOperationsContextProvider>\n            </BoardRefsContextProvider>\n          </BoardSetterContext.Provider>\n        </ChessEngineContext.Provider>\n      </BoardPromotionContextProvider>\n    </BoardContext.Provider>\n  );\n});\n\nconst ChessboardContextProvider = React.memo(\n  ChessboardContextProviderComponent\n);\nexport {\n  ChessboardContextProvider,\n  ChessEngineContext,\n  BoardContext,\n  BoardSetterContext,\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AAEA;;AAEA;;AACA;;AAIA;;AACA;;AACA;;;;;;AAOA,MAAMA,kCAAkC,gBAAGC,cAAA,CAAMC,UAAN,CAGzC,OAAoBC,GAApB,KAA4B;EAAA,IAA3B;IAAEC,QAAF;IAAYC;EAAZ,CAA2B;EAC5B,MAAMC,KAAK,GAAG,IAAAC,kBAAA,EAAS,MAAM,IAAIC,YAAJ,CAAUH,GAAV,CAAf,CAAd;EACA,MAAMI,aAAa,GAAG,IAAAC,aAAA,EAAsB,IAAtB,CAAtB;EACA,MAAMC,kBAAkB,GAAG,IAAAD,aAAA,EAA2B,IAA3B,CAA3B;EAEA,MAAM,CAACE,KAAD,EAAQC,QAAR,IAAoB,IAAAC,eAAA,EAASR,KAAK,CAACM,KAAN,EAAT,CAA1B;EAEA,MAAMG,oBAAmC,GAAG,IAAAC,cAAA,EAAQ,MAAM;IACxD,OAAO;MACLC,IAAI,EAAGC,MAAD;QAAA;;QAAA,gCAAYT,aAAa,CAACU,OAA1B,oFAAY,sBAAuBF,IAAnC,2DAAY,mDAA8BC,MAA9B,CAAZ;MAAA,CADD;MAELE,SAAS,EAAGF,MAAD;QAAA;;QAAA,iCAAYT,aAAa,CAACU,OAA1B,2DAAY,uBAAuBC,SAAvB,CAAiCF,MAAjC,CAAZ;MAAA,CAFN;MAGLG,0BAA0B,EAAE;QAAA;;QAAA,iCAC1BZ,aAAa,CAACU,OADY,2DAC1B,uBAAuBE,0BAAvB,EAD0B;MAAA,CAHvB;MAKLC,QAAQ,EAAE;QAAA;;QAAA,OAAMb,aAAN,aAAMA,aAAN,iDAAMA,aAAa,CAAEU,OAArB,2DAAM,uBAAwBG,QAAxB,EAAN;MAAA,CALL;MAMLC,UAAU,EAAGL,MAAD,IAAY;QAAA;;QACtB,0BAAAT,aAAa,CAACU,OAAd,kFAAuBI,UAAvB,CAAkCL,MAAlC;QACA,yBAAAP,kBAAkB,CAACQ,OAAnB,gFAA4BK,KAA5B;MACD;IATI,CAAP;EAWD,CAZ2C,EAYzC,EAZyC,CAA5C;EAcA,IAAAC,0BAAA,EAAoBtB,GAApB,EAAyB,MAAMY,oBAA/B,EAAqD,CAACA,oBAAD,CAArD;EAEA,oBACE,6BAAC,0BAAD,CAAc,QAAd;IAAuB,KAAK,EAAEH;EAA9B,gBACE,6BAAC,oDAAD,qBACE,6BAAC,sCAAD,CAAoB,QAApB;IAA6B,KAAK,EAAEN;EAApC,gBACE,6BAAC,gCAAD,CAAoB,QAApB;IAA6B,KAAK,EAAEO;EAApC,gBACE,6BAAC,0CAAD;IAA0B,GAAG,EAAEJ;EAA/B,gBACE,6BAAC,sDAAD;IACE,GAAG,EAAEE,kBADP;IAEE,UAAU,EAAEI;EAFd,GAIGX,QAJH,CADF,CADF,CADF,CADF,CADF,CADF;AAkBD,CA5C0C,CAA3C;;AA8CA,MAAMsB,yBAAyB,gBAAGzB,cAAA,CAAM0B,IAAN,CAChC3B,kCADgC,CAAlC"}