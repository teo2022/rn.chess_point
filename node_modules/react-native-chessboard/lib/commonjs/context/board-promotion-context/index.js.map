{"version":3,"names":["BoardPromotionContext","React","createContext","showPromotionDialog","isPromoting","BoardPromotionContextProvider","memo","children","dialog","setDialog","useState","isDialogActive","useCallback","type","onSelect","piece","value","useMemo"],"sources":["index.tsx"],"sourcesContent":["import React, { useCallback, useMemo, useState } from 'react';\nimport type { ChessInstance, PieceType } from 'chess.js';\nimport { PromotionDialog } from './dialog';\n\nexport type BoardPromotionContextType = {\n  showPromotionDialog: (_: {\n    type: PromotionDialogType;\n    onSelect?: (_: PieceType) => void;\n  }) => void;\n  isPromoting: boolean;\n};\n\nconst BoardPromotionContext = React.createContext<BoardPromotionContextType>({\n  showPromotionDialog: () => {\n    //\n  },\n  isPromoting: false,\n});\n\ntype PromotionDialogType = ReturnType<ChessInstance['turn']>;\n\nexport type BoardPromotionContextState = {\n  isDialogActive: boolean;\n  type?: PromotionDialogType;\n  onSelect?: (_: PieceType) => void;\n};\n\nconst BoardPromotionContextProvider: React.FC = React.memo(({ children }) => {\n  const [dialog, setDialog] = useState<BoardPromotionContextState>({\n    isDialogActive: false,\n  });\n\n  const showPromotionDialog: BoardPromotionContextType['showPromotionDialog'] =\n    useCallback(({ type, onSelect }) => {\n      setDialog({ isDialogActive: true, type, onSelect });\n    }, []);\n\n  const onSelect = useCallback(\n    (piece: PieceType) => {\n      dialog.onSelect?.(piece);\n      setDialog({ isDialogActive: false });\n    },\n    [dialog]\n  );\n\n  const value = useMemo(\n    () => ({\n      showPromotionDialog,\n      isPromoting: dialog.isDialogActive,\n    }),\n    [dialog.isDialogActive, showPromotionDialog]\n  );\n\n  return (\n    <BoardPromotionContext.Provider value={value}>\n      {dialog.isDialogActive && (\n        <PromotionDialog type=\"w\" {...dialog} onSelect={onSelect} />\n      )}\n      {children}\n    </BoardPromotionContext.Provider>\n  );\n});\n\nexport { BoardPromotionContextProvider, BoardPromotionContext };\n"],"mappings":";;;;;;;AAAA;;AAEA;;;;;;;;AAUA,MAAMA,qBAAqB,gBAAGC,cAAA,CAAMC,aAAN,CAA+C;EAC3EC,mBAAmB,EAAE,MAAM,CACzB;EACD,CAH0E;EAI3EC,WAAW,EAAE;AAJ8D,CAA/C,CAA9B;;;;AAeA,MAAMC,6BAAuC,gBAAGJ,cAAA,CAAMK,IAAN,CAAW,QAAkB;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EAC3E,MAAM,CAACC,MAAD,EAASC,SAAT,IAAsB,IAAAC,eAAA,EAAqC;IAC/DC,cAAc,EAAE;EAD+C,CAArC,CAA5B;EAIA,MAAMR,mBAAqE,GACzE,IAAAS,kBAAA,EAAY,SAAwB;IAAA,IAAvB;MAAEC,IAAF;MAAQC;IAAR,CAAuB;IAClCL,SAAS,CAAC;MAAEE,cAAc,EAAE,IAAlB;MAAwBE,IAAxB;MAA8BC;IAA9B,CAAD,CAAT;EACD,CAFD,EAEG,EAFH,CADF;EAKA,MAAMA,QAAQ,GAAG,IAAAF,kBAAA,EACdG,KAAD,IAAsB;IAAA;;IACpB,oBAAAP,MAAM,CAACM,QAAP,2EAAAN,MAAM,EAAYO,KAAZ,CAAN;IACAN,SAAS,CAAC;MAAEE,cAAc,EAAE;IAAlB,CAAD,CAAT;EACD,CAJc,EAKf,CAACH,MAAD,CALe,CAAjB;EAQA,MAAMQ,KAAK,GAAG,IAAAC,cAAA,EACZ,OAAO;IACLd,mBADK;IAELC,WAAW,EAAEI,MAAM,CAACG;EAFf,CAAP,CADY,EAKZ,CAACH,MAAM,CAACG,cAAR,EAAwBR,mBAAxB,CALY,CAAd;EAQA,oBACE,6BAAC,qBAAD,CAAuB,QAAvB;IAAgC,KAAK,EAAEa;EAAvC,GACGR,MAAM,CAACG,cAAP,iBACC,6BAAC,uBAAD;IAAiB,IAAI,EAAC;EAAtB,GAA8BH,MAA9B;IAAsC,QAAQ,EAAEM;EAAhD,GAFJ,EAIGP,QAJH,CADF;AAQD,CAlC+C,CAAhD"}