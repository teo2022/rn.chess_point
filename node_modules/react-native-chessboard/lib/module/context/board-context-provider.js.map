{"version":3,"names":["Chess","React","useImperativeHandle","useMemo","useRef","useState","useConst","BoardContext","BoardSetterContext","BoardOperationsContextProvider","BoardPromotionContextProvider","BoardRefsContextProvider","ChessEngineContext","ChessboardContextProviderComponent","forwardRef","ref","children","fen","chess","chessboardRef","boardOperationsRef","board","setBoard","chessboardController","move","params","current","highlight","resetAllHighlightedSquares","getState","resetBoard","reset","ChessboardContextProvider","memo"],"sources":["board-context-provider.tsx"],"sourcesContent":["import { Chess } from 'chess.js';\nimport React, { useImperativeHandle, useMemo, useRef, useState } from 'react';\nimport type { ChessboardState } from '../helpers/get-chessboard-state';\nimport { useConst } from '../hooks/use-const';\n\nimport { BoardContext, BoardSetterContext } from './board-context';\nimport {\n  BoardOperationsContextProvider,\n  BoardOperationsRef,\n} from './board-operations-context';\nimport { BoardPromotionContextProvider } from './board-promotion-context';\nimport { BoardRefsContextProvider, ChessboardRef } from './board-refs-context';\nimport { ChessEngineContext } from './chess-engine-context';\n\ntype BoardContextProviderProps = {\n  fen?: string;\n  children?: React.ReactNode;\n};\n\nconst ChessboardContextProviderComponent = React.forwardRef<\n  ChessboardRef,\n  BoardContextProviderProps\n>(({ children, fen }, ref) => {\n  const chess = useConst(() => new Chess(fen));\n  const chessboardRef = useRef<ChessboardRef>(null);\n  const boardOperationsRef = useRef<BoardOperationsRef>(null);\n\n  const [board, setBoard] = useState(chess.board());\n\n  const chessboardController: ChessboardRef = useMemo(() => {\n    return {\n      move: (params) => chessboardRef.current?.move?.(params),\n      highlight: (params) => chessboardRef.current?.highlight(params),\n      resetAllHighlightedSquares: () =>\n        chessboardRef.current?.resetAllHighlightedSquares(),\n      getState: () => chessboardRef?.current?.getState() as ChessboardState,\n      resetBoard: (params) => {\n        chessboardRef.current?.resetBoard(params);\n        boardOperationsRef.current?.reset();\n      },\n    };\n  }, []);\n\n  useImperativeHandle(ref, () => chessboardController, [chessboardController]);\n\n  return (\n    <BoardContext.Provider value={board}>\n      <BoardPromotionContextProvider>\n        <ChessEngineContext.Provider value={chess}>\n          <BoardSetterContext.Provider value={setBoard}>\n            <BoardRefsContextProvider ref={chessboardRef}>\n              <BoardOperationsContextProvider\n                ref={boardOperationsRef}\n                controller={chessboardController}\n              >\n                {children}\n              </BoardOperationsContextProvider>\n            </BoardRefsContextProvider>\n          </BoardSetterContext.Provider>\n        </ChessEngineContext.Provider>\n      </BoardPromotionContextProvider>\n    </BoardContext.Provider>\n  );\n});\n\nconst ChessboardContextProvider = React.memo(\n  ChessboardContextProviderComponent\n);\nexport {\n  ChessboardContextProvider,\n  ChessEngineContext,\n  BoardContext,\n  BoardSetterContext,\n};\n"],"mappings":"AAAA,SAASA,KAAT,QAAsB,UAAtB;AACA,OAAOC,KAAP,IAAgBC,mBAAhB,EAAqCC,OAArC,EAA8CC,MAA9C,EAAsDC,QAAtD,QAAsE,OAAtE;AAEA,SAASC,QAAT,QAAyB,oBAAzB;AAEA,SAASC,YAAT,EAAuBC,kBAAvB,QAAiD,iBAAjD;AACA,SACEC,8BADF,QAGO,4BAHP;AAIA,SAASC,6BAAT,QAA8C,2BAA9C;AACA,SAASC,wBAAT,QAAwD,sBAAxD;AACA,SAASC,kBAAT,QAAmC,wBAAnC;AAOA,MAAMC,kCAAkC,gBAAGZ,KAAK,CAACa,UAAN,CAGzC,OAAoBC,GAApB,KAA4B;EAAA,IAA3B;IAAEC,QAAF;IAAYC;EAAZ,CAA2B;EAC5B,MAAMC,KAAK,GAAGZ,QAAQ,CAAC,MAAM,IAAIN,KAAJ,CAAUiB,GAAV,CAAP,CAAtB;EACA,MAAME,aAAa,GAAGf,MAAM,CAAgB,IAAhB,CAA5B;EACA,MAAMgB,kBAAkB,GAAGhB,MAAM,CAAqB,IAArB,CAAjC;EAEA,MAAM,CAACiB,KAAD,EAAQC,QAAR,IAAoBjB,QAAQ,CAACa,KAAK,CAACG,KAAN,EAAD,CAAlC;EAEA,MAAME,oBAAmC,GAAGpB,OAAO,CAAC,MAAM;IACxD,OAAO;MACLqB,IAAI,EAAGC,MAAD;QAAA;;QAAA,gCAAYN,aAAa,CAACO,OAA1B,oFAAY,sBAAuBF,IAAnC,2DAAY,mDAA8BC,MAA9B,CAAZ;MAAA,CADD;MAELE,SAAS,EAAGF,MAAD;QAAA;;QAAA,iCAAYN,aAAa,CAACO,OAA1B,2DAAY,uBAAuBC,SAAvB,CAAiCF,MAAjC,CAAZ;MAAA,CAFN;MAGLG,0BAA0B,EAAE;QAAA;;QAAA,iCAC1BT,aAAa,CAACO,OADY,2DAC1B,uBAAuBE,0BAAvB,EAD0B;MAAA,CAHvB;MAKLC,QAAQ,EAAE;QAAA;;QAAA,OAAMV,aAAN,aAAMA,aAAN,iDAAMA,aAAa,CAAEO,OAArB,2DAAM,uBAAwBG,QAAxB,EAAN;MAAA,CALL;MAMLC,UAAU,EAAGL,MAAD,IAAY;QAAA;;QACtB,0BAAAN,aAAa,CAACO,OAAd,kFAAuBI,UAAvB,CAAkCL,MAAlC;QACA,yBAAAL,kBAAkB,CAACM,OAAnB,gFAA4BK,KAA5B;MACD;IATI,CAAP;EAWD,CAZkD,EAYhD,EAZgD,CAAnD;EAcA7B,mBAAmB,CAACa,GAAD,EAAM,MAAMQ,oBAAZ,EAAkC,CAACA,oBAAD,CAAlC,CAAnB;EAEA,oBACE,oBAAC,YAAD,CAAc,QAAd;IAAuB,KAAK,EAAEF;EAA9B,gBACE,oBAAC,6BAAD,qBACE,oBAAC,kBAAD,CAAoB,QAApB;IAA6B,KAAK,EAAEH;EAApC,gBACE,oBAAC,kBAAD,CAAoB,QAApB;IAA6B,KAAK,EAAEI;EAApC,gBACE,oBAAC,wBAAD;IAA0B,GAAG,EAAEH;EAA/B,gBACE,oBAAC,8BAAD;IACE,GAAG,EAAEC,kBADP;IAEE,UAAU,EAAEG;EAFd,GAIGP,QAJH,CADF,CADF,CADF,CADF,CADF,CADF;AAkBD,CA5C0C,CAA3C;AA8CA,MAAMgB,yBAAyB,gBAAG/B,KAAK,CAACgC,IAAN,CAChCpB,kCADgC,CAAlC;AAGA,SACEmB,yBADF,EAEEpB,kBAFF,EAGEL,YAHF,EAIEC,kBAJF"}