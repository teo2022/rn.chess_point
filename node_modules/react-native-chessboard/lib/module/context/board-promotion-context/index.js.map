{"version":3,"names":["React","useCallback","useMemo","useState","PromotionDialog","BoardPromotionContext","createContext","showPromotionDialog","isPromoting","BoardPromotionContextProvider","memo","children","dialog","setDialog","isDialogActive","type","onSelect","piece","value"],"sources":["index.tsx"],"sourcesContent":["import React, { useCallback, useMemo, useState } from 'react';\nimport type { ChessInstance, PieceType } from 'chess.js';\nimport { PromotionDialog } from './dialog';\n\nexport type BoardPromotionContextType = {\n  showPromotionDialog: (_: {\n    type: PromotionDialogType;\n    onSelect?: (_: PieceType) => void;\n  }) => void;\n  isPromoting: boolean;\n};\n\nconst BoardPromotionContext = React.createContext<BoardPromotionContextType>({\n  showPromotionDialog: () => {\n    //\n  },\n  isPromoting: false,\n});\n\ntype PromotionDialogType = ReturnType<ChessInstance['turn']>;\n\nexport type BoardPromotionContextState = {\n  isDialogActive: boolean;\n  type?: PromotionDialogType;\n  onSelect?: (_: PieceType) => void;\n};\n\nconst BoardPromotionContextProvider: React.FC = React.memo(({ children }) => {\n  const [dialog, setDialog] = useState<BoardPromotionContextState>({\n    isDialogActive: false,\n  });\n\n  const showPromotionDialog: BoardPromotionContextType['showPromotionDialog'] =\n    useCallback(({ type, onSelect }) => {\n      setDialog({ isDialogActive: true, type, onSelect });\n    }, []);\n\n  const onSelect = useCallback(\n    (piece: PieceType) => {\n      dialog.onSelect?.(piece);\n      setDialog({ isDialogActive: false });\n    },\n    [dialog]\n  );\n\n  const value = useMemo(\n    () => ({\n      showPromotionDialog,\n      isPromoting: dialog.isDialogActive,\n    }),\n    [dialog.isDialogActive, showPromotionDialog]\n  );\n\n  return (\n    <BoardPromotionContext.Provider value={value}>\n      {dialog.isDialogActive && (\n        <PromotionDialog type=\"w\" {...dialog} onSelect={onSelect} />\n      )}\n      {children}\n    </BoardPromotionContext.Provider>\n  );\n});\n\nexport { BoardPromotionContextProvider, BoardPromotionContext };\n"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,OAA7B,EAAsCC,QAAtC,QAAsD,OAAtD;AAEA,SAASC,eAAT,QAAgC,UAAhC;AAUA,MAAMC,qBAAqB,gBAAGL,KAAK,CAACM,aAAN,CAA+C;EAC3EC,mBAAmB,EAAE,MAAM,CACzB;EACD,CAH0E;EAI3EC,WAAW,EAAE;AAJ8D,CAA/C,CAA9B;AAeA,MAAMC,6BAAuC,gBAAGT,KAAK,CAACU,IAAN,CAAW,QAAkB;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EAC3E,MAAM,CAACC,MAAD,EAASC,SAAT,IAAsBV,QAAQ,CAA6B;IAC/DW,cAAc,EAAE;EAD+C,CAA7B,CAApC;EAIA,MAAMP,mBAAqE,GACzEN,WAAW,CAAC,SAAwB;IAAA,IAAvB;MAAEc,IAAF;MAAQC;IAAR,CAAuB;IAClCH,SAAS,CAAC;MAAEC,cAAc,EAAE,IAAlB;MAAwBC,IAAxB;MAA8BC;IAA9B,CAAD,CAAT;EACD,CAFU,EAER,EAFQ,CADb;EAKA,MAAMA,QAAQ,GAAGf,WAAW,CACzBgB,KAAD,IAAsB;IAAA;;IACpB,oBAAAL,MAAM,CAACI,QAAP,2EAAAJ,MAAM,EAAYK,KAAZ,CAAN;IACAJ,SAAS,CAAC;MAAEC,cAAc,EAAE;IAAlB,CAAD,CAAT;EACD,CAJyB,EAK1B,CAACF,MAAD,CAL0B,CAA5B;EAQA,MAAMM,KAAK,GAAGhB,OAAO,CACnB,OAAO;IACLK,mBADK;IAELC,WAAW,EAAEI,MAAM,CAACE;EAFf,CAAP,CADmB,EAKnB,CAACF,MAAM,CAACE,cAAR,EAAwBP,mBAAxB,CALmB,CAArB;EAQA,oBACE,oBAAC,qBAAD,CAAuB,QAAvB;IAAgC,KAAK,EAAEW;EAAvC,GACGN,MAAM,CAACE,cAAP,iBACC,oBAAC,eAAD;IAAiB,IAAI,EAAC;EAAtB,GAA8BF,MAA9B;IAAsC,QAAQ,EAAEI;EAAhD,GAFJ,EAIGL,QAJH,CADF;AAQD,CAlC+C,CAAhD;AAoCA,SAASF,6BAAT,EAAwCJ,qBAAxC"}